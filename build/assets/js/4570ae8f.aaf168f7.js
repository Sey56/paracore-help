"use strict";(globalThis.webpackChunkparacore_help=globalThis.webpackChunkparacore_help||[]).push([[2527],{7829:(e,r,n)=>{n.r(r),n.d(r,{assets:()=>c,contentTitle:()=>l,default:()=>h,frontMatter:()=>a,metadata:()=>i,toc:()=>o});const i=JSON.parse('{"id":"user-guide/script-categories-and-metadata","title":"Script Categories and Metadata","description":"Paracore provides robust mechanisms for organizing, filtering, and understanding your C# Revit scripts through categories and metadata. This system helps both individual users and teams manage their automation library effectively.","source":"@site/docs/user-guide/script-categories-and-metadata.md","sourceDirName":"user-guide","slug":"/user-guide/script-categories-and-metadata","permalink":"/paracore-help/docs/user-guide/script-categories-and-metadata","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"id":"script-categories-and-metadata","title":"Script Categories and Metadata","sidebar_label":"Script Categories & Metadata"},"sidebar":"tutorialSidebar","previous":{"title":"Script Gallery","permalink":"/paracore-help/docs/user-guide/script-gallery"},"next":{"title":"Script Inspector","permalink":"/paracore-help/docs/user-guide/script-inspector"}}');var t=n(4848),s=n(8453);const a={id:"script-categories-and-metadata",title:"Script Categories and Metadata",sidebar_label:"Script Categories & Metadata"},l=void 0,c={},o=[{value:"Script Types",id:"script-types",level:2},{value:"Script Sources",id:"script-sources",level:3},{value:"Single-File Scripts",id:"single-file-scripts",level:3},{value:"Multi-File Scripts",id:"multi-file-scripts",level:3},{value:"Script Metadata",id:"script-metadata",level:3},{value:"Multi-File Scripts: Params Class in Separate File",id:"multi-file-scripts-params-class-in-separate-file",level:3},{value:"Static Metadata Fields",id:"static-metadata-fields",level:3},{value:"Dynamic Metadata",id:"dynamic-metadata",level:3},{value:"Built-in Categories",id:"built-in-categories",level:3},{value:"Custom Categories",id:"custom-categories",level:3}];function d(e){const r={blockquote:"blockquote",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(r.p,{children:"Paracore provides robust mechanisms for organizing, filtering, and understanding your C# Revit scripts through categories and metadata. This system helps both individual users and teams manage their automation library effectively."}),"\n",(0,t.jsx)(r.h2,{id:"script-types",children:"Script Types"}),"\n",(0,t.jsxs)(r.p,{children:["Paracore supports two types of scripts, both organized within ",(0,t.jsx)(r.strong,{children:"Script Sources"}),":"]}),"\n",(0,t.jsx)(r.h3,{id:"script-sources",children:"Script Sources"}),"\n",(0,t.jsxs)(r.p,{children:["A ",(0,t.jsx)(r.strong,{children:"Script Source"})," is a location containing your scripts:"]}),"\n",(0,t.jsxs)(r.ul,{children:["\n",(0,t.jsxs)(r.li,{children:[(0,t.jsx)(r.strong,{children:"Local Folders:"})," Directories on your computer"]}),"\n",(0,t.jsxs)(r.li,{children:[(0,t.jsx)(r.strong,{children:"Workspaces:"})," Git repositories for team collaboration"]}),"\n"]}),"\n",(0,t.jsx)(r.h3,{id:"single-file-scripts",children:"Single-File Scripts"}),"\n",(0,t.jsxs)(r.p,{children:["Simple scripts contained in a single ",(0,t.jsx)(r.code,{children:".cs"})," file using C# top-level statements (introduced in C# 9)."]}),"\n",(0,t.jsx)(r.p,{children:(0,t.jsx)(r.strong,{children:"Characteristics:"})}),"\n",(0,t.jsxs)(r.ul,{children:["\n",(0,t.jsxs)(r.li,{children:["No ",(0,t.jsx)(r.code,{children:"class Program"})," or ",(0,t.jsx)(r.code,{children:"public static void Main()"})," boilerplate"]}),"\n",(0,t.jsx)(r.li,{children:"Can include user-defined types (classes, interfaces) after all top-level statements"}),"\n",(0,t.jsx)(r.li,{children:"Ideal for straightforward automation tasks"}),"\n"]}),"\n",(0,t.jsx)(r.p,{children:(0,t.jsx)(r.strong,{children:"Example:"})}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-csharp",children:'using Autodesk.Revit.DB;\r\n\r\n/* Metadata here */\r\n\r\n// Top-level statements (script logic)\r\nvar p = new Params();\r\nPrintln("Creating wall...");\r\n\r\n// User-defined types come AFTER top-level statements\r\nclass Params { }\n'})}),"\n",(0,t.jsx)(r.h3,{id:"multi-file-scripts",children:"Multi-File Scripts"}),"\n",(0,t.jsx)(r.p,{children:"Complex scripts organized in folders for better modularity."}),"\n",(0,t.jsx)(r.p,{children:(0,t.jsx)(r.strong,{children:"Characteristics:"})}),"\n",(0,t.jsxs)(r.ul,{children:["\n",(0,t.jsxs)(r.li,{children:[(0,t.jsx)(r.strong,{children:"Folder Name = Script Name"})," (displayed in Script Gallery)"]}),"\n",(0,t.jsxs)(r.li,{children:["Contains one or more ",(0,t.jsx)(r.code,{children:".cs"})," files"]}),"\n",(0,t.jsxs)(r.li,{children:["One file must be the ",(0,t.jsx)(r.strong,{children:"entry file"})," (top-level statements)"]}),"\n",(0,t.jsx)(r.li,{children:"Engine automatically combines all files for execution"}),"\n"]}),"\n",(0,t.jsx)(r.p,{children:(0,t.jsx)(r.strong,{children:"Recommended Naming:"})}),"\n",(0,t.jsxs)(r.ul,{children:["\n",(0,t.jsxs)(r.li,{children:["Entry file: Same as folder name (e.g., ",(0,t.jsx)(r.code,{children:"Create_Walls.cs"}),") or ",(0,t.jsx)(r.code,{children:"Main.cs"})]}),"\n",(0,t.jsxs)(r.li,{children:["Other files: Descriptive names (e.g., ",(0,t.jsx)(r.code,{children:"Params.cs"}),", ",(0,t.jsx)(r.code,{children:"GridWalls.cs"}),")"]}),"\n"]}),"\n",(0,t.jsx)(r.p,{children:(0,t.jsx)(r.strong,{children:"Example Structure:"})}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{children:"Create_Walls/               \u2190 Script name in gallery\r\n\u251c\u2500\u2500 Create_Walls.cs         \u2190 Entry file (top-level statements + metadata)\r\n\u251c\u2500\u2500 Params.cs               \u2190 Parameter definitions\r\n\u251c\u2500\u2500 GridWalls.cs            \u2190 Helper functions\r\n\u2514\u2500\u2500 RoomBoundaryWalls.cs    \u2190 Helper functions\n"})}),"\n",(0,t.jsxs)(r.blockquote,{children:["\n",(0,t.jsx)(r.p,{children:"[!TIP]\r\nUse multi-file scripts when your automation logic is complex or exceeds ~200 lines. The engine seamlessly combines all files into a single script for execution."}),"\n"]}),"\n",(0,t.jsx)(r.h3,{id:"script-metadata",children:"Script Metadata"}),"\n",(0,t.jsxs)(r.p,{children:["Metadata is descriptive information embedded directly within your C# scripts using a multi-line comment block. This block must be placed ",(0,t.jsxs)(r.strong,{children:["immediately after the ",(0,t.jsx)(r.code,{children:"using"})," statements"]})," in the ",(0,t.jsx)(r.strong,{children:"top-level statement file"})," (the entry script)."]}),"\n",(0,t.jsxs)(r.blockquote,{children:["\n",(0,t.jsxs)(r.p,{children:["[!IMPORTANT]\r\n",(0,t.jsx)(r.strong,{children:"Single-File Scripts:"})," Metadata goes at the top of the ",(0,t.jsx)(r.code,{children:".cs"})," file, right after ",(0,t.jsx)(r.code,{children:"using"})," statements."]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"Multi-File Scripts:"})," Metadata goes in the entry file (the file with the same name as the folder), right after ",(0,t.jsx)(r.code,{children:"using"})," statements. Other files in the folder should NOT contain metadata."]}),"\n"]}),"\n",(0,t.jsx)(r.p,{children:"Paracore distinguishes between two types of metadata:"}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"Static Metadata"})," - User-defined fields you write in the script:"]}),"\n",(0,t.jsxs)(r.ul,{children:["\n",(0,t.jsxs)(r.li,{children:[(0,t.jsx)(r.code,{children:"DocumentType"}),", ",(0,t.jsx)(r.code,{children:"Categories"}),", ",(0,t.jsx)(r.code,{children:"Author"}),", ",(0,t.jsx)(r.code,{children:"Dependencies"}),", ",(0,t.jsx)(r.code,{children:"Description"}),", ",(0,t.jsx)(r.code,{children:"UsageExamples"})]}),"\n"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"Dynamic Metadata"})," - Automatically extracted by the engine:"]}),"\n",(0,t.jsxs)(r.ul,{children:["\n",(0,t.jsx)(r.li,{children:"File name, absolute path, date created, date modified, last run timestamp, Git information"}),"\n"]}),"\n",(0,t.jsx)(r.p,{children:"Here's an example of a script with its metadata:"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-csharp",children:'using Autodesk.Revit.DB;\r\n\r\n/*\r\nDocumentType: Project\r\nCategories: Architectural, Prototyping\r\nAuthor: Paracore Team\r\nDependencies: RevitAPI 2025, CoreScript.Engine, Paracore.Addin\r\n\r\nDescription:\r\nCreates a wall along the X-axis at a user-defined level with specified length and height.\r\nParameters allow customizing geometry in meters. Great for layout prototyping.\r\n\r\nUsageExamples:\r\n- "Create a linear wall along X-axis"\r\n- "Create a wall of 8m length and 3m height on \'Level 1\'"\r\n*/\r\n\r\nclass Params\r\n{\r\n    [ScriptParameter]\r\n    public string levelName = "Level 1";\r\n    \r\n    [ScriptParameter(Min: 1.0, Max: 20.0)]\r\n    public double wallLengthMeters = 6.0;\r\n    \r\n    [ScriptParameter(Min: 1.0, Max: 10.0)]\r\n    public double wallHeightMeters = 3.0;\r\n}\r\n\r\nvar p = new Params();\r\n\r\n// Convert to Revit internal units (feet)\r\ndouble lengthFt = UnitUtils.ConvertToInternalUnits(p.wallLengthMeters, UnitTypeId.Meters);\r\ndouble heightFt = UnitUtils.ConvertToInternalUnits(p.wallHeightMeters, UnitTypeId.Meters);\r\n\r\n// Create wall geometry\r\nXYZ pt1 = new(-lengthFt / 2, 0, 0);\r\nXYZ pt2 = new(lengthFt / 2, 0, 0);\r\nLine wallLine = Line.CreateBound(pt1, pt2);\r\n\r\n// Find level\r\nLevel? level = new FilteredElementCollector(Doc)\r\n    .OfClass(typeof(Level))\r\n    .Cast<Level>()\r\n    .FirstOrDefault(l => l.Name == p.levelName);\r\n\r\nif (level == null)\r\n{\r\n    Println($"\u274c Level \'{p.levelName}\' not found.");\r\n    return;\r\n}\r\n\r\nPrintln($"Preparing to create wall of {p.wallLengthMeters}m \xd7 {p.wallHeightMeters}m on \'{p.levelName}\'...");\r\n\r\n// Create wall in transaction\r\nTransact("Create Wall", () =>\r\n{\r\n    Wall wall = Wall.Create(Doc, wallLine, level.Id, false);\r\n    wall.get_Parameter(BuiltInParameter.WALL_USER_HEIGHT_PARAM)?.Set(heightFt);\r\n});\r\n\r\nPrintln("\u2705 Wall created.");\n'})}),"\n",(0,t.jsx)(r.h3,{id:"multi-file-scripts-params-class-in-separate-file",children:"Multi-File Scripts: Params Class in Separate File"}),"\n",(0,t.jsxs)(r.p,{children:["For complex multi-file scripts, you can define the ",(0,t.jsx)(r.code,{children:"Params"})," class in its own file (e.g., ",(0,t.jsx)(r.code,{children:"Params.cs"}),"):"]}),"\n",(0,t.jsx)(r.p,{children:(0,t.jsx)(r.strong,{children:"Folder Structure:"})}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{children:"Create_Walls/\r\n\u251c\u2500\u2500 Create_Walls.cs    (Entry file with metadata and top-level statements)\r\n\u251c\u2500\u2500 Params.cs          (Params class definition)\r\n\u251c\u2500\u2500 GridWalls.cs       (Helper functions)\r\n\u2514\u2500\u2500 RoomBoundaryWalls.cs (Helper functions)\n"})}),"\n",(0,t.jsx)(r.p,{children:(0,t.jsx)(r.strong,{children:"Create_Walls.cs (Entry File):"})}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-csharp",children:'using Autodesk.Revit.DB;\r\n\r\n/*\r\nDocumentType: Project\r\nCategories: Architectural, Structural\r\nAuthor: Paracore Team\r\nDependencies: RevitAPI 2025, CoreScript.Engine, Paracore.Addin\r\n\r\nDescription:\r\nComprehensive wall creation tool supporting multiple automation modes.\r\n\r\nUsageExamples:\r\n- "Create walls around all rooms on Level 1"\r\n- "Generate a 5x5 office grid with 3m spacing"\r\n*/\r\n\r\n// Initialize Parameters from separate file\r\nvar p = new Params();\r\n\r\n// Script logic here...\n'})}),"\n",(0,t.jsx)(r.p,{children:(0,t.jsx)(r.strong,{children:"Params.cs (Separate File):"})}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-csharp",children:'class Params\r\n{\r\n    [ScriptParameter(Group: "Mode", Options: "Room Boundaries,Grid Layout,Coordinates,Perimeter")]\r\n    public string creationMode = "Room Boundaries";\r\n\r\n    [RevitElements(Type: "Level", Group: "General")]\r\n    public string levelName = "Level 1";\r\n\r\n    [RevitElements(Type: "WallType", Group: "General")]\r\n    public string wallTypeName = "Generic - 200mm";\r\n\r\n    [ScriptParameter(Group: "Grid", Min: 1, Max: 20)]\r\n    public int gridRows = 5;\r\n\r\n    [ScriptParameter(Group: "Grid", Min: 1, Max: 20)]\r\n    public int gridColumns = 5;\r\n}\n'})}),"\n",(0,t.jsxs)(r.blockquote,{children:["\n",(0,t.jsxs)(r.p,{children:["[!TIP]\r\n",(0,t.jsx)(r.strong,{children:"Key Rules for Multi-File Scripts:"})]}),"\n",(0,t.jsxs)(r.ul,{children:["\n",(0,t.jsxs)(r.li,{children:["Metadata must be in the ",(0,t.jsx)(r.strong,{children:"entry file"})," (file with same name as folder)"]}),"\n",(0,t.jsxs)(r.li,{children:["Parameters can be defined in the entry file OR in a separate ",(0,t.jsx)(r.code,{children:"Params.cs"})," file"]}),"\n",(0,t.jsx)(r.li,{children:"Helper functions and classes can be in any file in the folder"}),"\n",(0,t.jsxs)(r.li,{children:["The engine automatically discovers and combines all ",(0,t.jsx)(r.code,{children:".cs"})," files"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(r.h3,{id:"static-metadata-fields",children:"Static Metadata Fields"}),"\n",(0,t.jsx)(r.p,{children:"These fields are defined by the script author in the metadata comment block:"}),"\n",(0,t.jsxs)(r.ul,{children:["\n",(0,t.jsxs)(r.li,{children:[(0,t.jsx)(r.strong,{children:(0,t.jsx)(r.code,{children:"DocumentType"})}),": Specifies the type of Revit document required (e.g., ",(0,t.jsx)(r.code,{children:"Project"}),", ",(0,t.jsx)(r.code,{children:"ConceptualMass"}),", ",(0,t.jsx)(r.code,{children:"Family"}),"). Paracore uses this to enable/disable scripts based on the active document type."]}),"\n",(0,t.jsxs)(r.li,{children:[(0,t.jsx)(r.strong,{children:(0,t.jsx)(r.code,{children:"Categories"})}),": Comma-separated list of categories (e.g., ",(0,t.jsx)(r.code,{children:"Architectural, Prototyping"}),"). Scripts can belong to multiple categories for flexible organization."]}),"\n",(0,t.jsxs)(r.li,{children:[(0,t.jsx)(r.strong,{children:(0,t.jsx)(r.code,{children:"Author"})}),": The creator of the script."]}),"\n",(0,t.jsxs)(r.li,{children:[(0,t.jsx)(r.strong,{children:(0,t.jsx)(r.code,{children:"Dependencies"})}),": Lists required dependencies (e.g., ",(0,t.jsx)(r.code,{children:"RevitAPI 2025, CoreScript.Engine, Paracore.Addin"}),")."]}),"\n",(0,t.jsxs)(r.li,{children:[(0,t.jsx)(r.strong,{children:(0,t.jsx)(r.code,{children:"Description"})}),": A brief explanation of what the script does. Can be multi-line."]}),"\n",(0,t.jsxs)(r.li,{children:[(0,t.jsx)(r.strong,{children:(0,t.jsx)(r.code,{children:"UsageExamples"})}),": Natural language examples of how to use the script. Used by the AI agent for script discovery."]}),"\n"]}),"\n",(0,t.jsx)(r.h3,{id:"dynamic-metadata",children:"Dynamic Metadata"}),"\n",(0,t.jsx)(r.p,{children:"These fields are automatically extracted by Paracore:"}),"\n",(0,t.jsxs)(r.ul,{children:["\n",(0,t.jsxs)(r.li,{children:[(0,t.jsx)(r.strong,{children:"File Name"}),": Extracted from the script filename"]}),"\n",(0,t.jsxs)(r.li,{children:[(0,t.jsx)(r.strong,{children:"Absolute Path"}),": Full file system path (used for execution)"]}),"\n",(0,t.jsxs)(r.li,{children:[(0,t.jsx)(r.strong,{children:"Date Created"}),": File creation timestamp"]}),"\n",(0,t.jsxs)(r.li,{children:[(0,t.jsx)(r.strong,{children:"Date Modified"}),": Last modification timestamp"]}),"\n",(0,t.jsxs)(r.li,{children:[(0,t.jsx)(r.strong,{children:"Last Run"}),": Automatically updated when the script executes"]}),"\n",(0,t.jsxs)(r.li,{children:[(0,t.jsx)(r.strong,{children:"Git Information"}),": Branch, commit hash, and status (if in a Git repository)"]}),"\n"]}),"\n",(0,t.jsx)(r.h3,{id:"built-in-categories",children:"Built-in Categories"}),"\n",(0,t.jsx)(r.p,{children:"Paracore provides three built-in category filters at the top of the Script Gallery:"}),"\n",(0,t.jsxs)(r.ul,{children:["\n",(0,t.jsx)(r.li,{children:(0,t.jsx)(r.strong,{children:"Architectural"})}),"\n",(0,t.jsx)(r.li,{children:(0,t.jsx)(r.strong,{children:"Structural"})}),"\n",(0,t.jsx)(r.li,{children:(0,t.jsx)(r.strong,{children:"MEP"})}),"\n"]}),"\n",(0,t.jsxs)(r.p,{children:["These checkboxes are unchecked by default (showing all scripts). Checking a category filters the gallery to show only scripts that include that category in their ",(0,t.jsx)(r.code,{children:"Categories"})," metadata."]}),"\n",(0,t.jsx)(r.p,{children:(0,t.jsx)(r.strong,{children:"Example:"})}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-csharp",children:"/*\r\nCategories: Architectural, Prototyping\r\n*/\n"})}),"\n",(0,t.jsxs)(r.p,{children:["This script will be shown when the ",(0,t.jsx)(r.strong,{children:"Architectural"})," checkbox is checked."]}),"\n",(0,t.jsx)(r.h3,{id:"custom-categories",children:"Custom Categories"}),"\n",(0,t.jsxs)(r.p,{children:["You can create custom categories in the ",(0,t.jsx)(r.strong,{children:"Sidebar"}),' under "Custom Categories" by clicking the ',(0,t.jsx)(r.code,{children:"+"})," button. Once created, selecting a custom category filters the gallery to show scripts that include that category name in their metadata."]}),"\n",(0,t.jsx)(r.p,{children:(0,t.jsx)(r.strong,{children:"Example:"})}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-csharp",children:"/*\r\nCategories: Prototyping, QA\r\n*/\n"})}),"\n",(0,t.jsx)(r.p,{children:'To filter scripts with "Prototyping" or "QA", create those custom categories in the sidebar.'}),"\n",(0,t.jsxs)(r.blockquote,{children:["\n",(0,t.jsxs)(r.p,{children:["[!TIP]\r\nYou can also use the search bar with ",(0,t.jsx)(r.code,{children:"categories: Architectural"})," to filter by category."]}),"\n"]}),"\n",(0,t.jsx)(r.p,{children:"This flexible categorization system helps you organize and find scripts quickly, whether using built-in or custom categories tailored to your workflow."})]})}function h(e={}){const{wrapper:r}={...(0,s.R)(),...e.components};return r?(0,t.jsx)(r,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},8453:(e,r,n)=>{n.d(r,{R:()=>a,x:()=>l});var i=n(6540);const t={},s=i.createContext(t);function a(e){const r=i.useContext(s);return i.useMemo(function(){return"function"==typeof e?e(r):{...r,...e}},[r,e])}function l(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:a(e.components),i.createElement(s.Provider,{value:r},e.children)}}}]);